# ========================================
# TCP/NTCP Model Parameters
# Lung Cancer Radiotherapy
# ========================================

# ----------------------------------------
# TCP (Tumor Control Probability)
# ----------------------------------------
# Model: Niemierko (EUD-based)
# Formulas:
#   EUD = ( Σ vᵢ × Dᵢ^a )^(1/a)
#   TCP = 1 / ( 1 + (TCD50 / EUD)^(4×γ₅₀) )
#
# Reference: Niemierko A. (1997). Med Phys 24(1):103-110

tcp:
  ptv:
    a: -10              # Tissue parameter (negative for tumors)
    tcd50_gy: 60.0      # Dose for 50% tumor control probability (Gy)
    gamma50: 2.0        # Slope of dose-response curve
    eqd2_conversion: false
    alpha_beta: 10.0    # For EQD2 conversion (if enabled)

  ctv:
    a: -10              # Tissue parameter (negative for tumors)
    tcd50_gy: 60.0      # Dose for 50% tumor control probability (Gy)
    gamma50: 2.0        # Slope of dose-response curve

# ----------------------------------------
# NTCP (Normal Tissue Complication Probability)
# ----------------------------------------
# Model: Niemierko EUD-logistic (same formula as TCP)
# Formulas:
#   EUD = ( Σ vᵢ × Dᵢ^a )^(1/a)
#   NTCP = 1 / ( 1 + (TD50 / EUD)^(4×γ₅₀) )
#
# Reference: Niemierko A. (1997). Med Phys 24(1):103-110

ntcp:
  lung:
    a: 1                                 # Volume parameter (a=1 → EUD = mean dose)
    gamma50: 2                           # Slope of dose-response curve
    td50_gy: 24.5                        # Dose for 50% complication probability (Gy)
    endpoint: "pneumonitis grade ≥2"     # Clinical endpoint

  heart:
    a: 3                                 # Volume parameter (parallel organ)
    gamma50: 3                           # Slope of dose-response curve
    td50_gy: 50                          # Dose for 50% complication probability (Gy)
    endpoint: "pericarditis"

  esophagus:
    a: 19                                # Volume parameter (serial-like organ)
    gamma50: 4                           # Slope of dose-response curve
    td50_gy: 68                          # Dose for 50% complication probability (Gy)
    endpoint: "perforation"

  spinal_cord:
    a: 20                                # Volume parameter (serial organ, EUD ≈ Dmax)
    gamma50: 2.28                        # Slope of dose-response curve
    td50_gy: 66.5                        # Dose for 50% complication probability (Gy)
    endpoint: "myelitis/necrosis"
    # NOTE: These parameters are derived from LKB model mapping
    # (n=0.05, m=0.175, TD50=50 Gy → EUD). Not directly tabulated
    # by Niemierko. Sensitivity analysis recommended.

# ----------------------------------------
# Structure Mapping
# ----------------------------------------
# Priority order (left to right): first match is used
structure_mapping:
  ptv:
    - "PTV_6600"
    - "PTV_6000"
    - "PTV"
  ctv:
    - "CTV_6600"
    - "CTV_6000"
    - "CTV"
  lung:
    - "LUNG_TOTAL"     # standard total lung for NTCP
    - "LUNGS"
  heart:
    - "HEART"
  esophagus:
    - "ESOPHAGUS"
    - "OESOPHAGUS"
  spinal_cord:
    - "SPINAL_CORD"
    - "CORD"
